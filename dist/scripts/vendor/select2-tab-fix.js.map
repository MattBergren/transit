{"version":3,"sources":["vendor/select2-tab-fix.js"],"names":["jQuery","document","ready","$","docBody","body","shiftPressed","clickedOutside","isIE11","window","MSInputMethodContext","documentMode","on","e","keyCaptured","keyCode","which","target","is","attr","removeAttr","elSelect","currentForm","closest","othersOpen","has","length","inputs","find","not","parent","elFocus","each","index","elInput","eq","isSelect2","siblings","select2","focus"],"mappings":"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","file":"select2-tab-fix.js","sourcesContent":["/**\n * Solution by zDaniels http://stackoverflow.com/a/39605870/909648\n * Adapted by Deac Karns https://github.com/peledies\n *\n * WARNING: untested using Select2's option ['selectOnClose'=>true]\n *\n * This code was written because the Select2 widget does not handle\n * tabbing from one form field to another.  The desired behavior is that\n * the user can use [Enter] to select a value from Select2 and [Tab] to move\n * to the next field on the form.\n *\n * The following code moves focus to the next form field when a Select2 'close'\n * event is triggered.  If the next form field is a Select2 widget, the widget\n * is opened automatically.\n *\n * Users that click elsewhere on the document will cause the active Select2\n * widget to close.  To prevent the code from overriding the user's focus choice\n * a flag is added to each element that the users clicks on.  If the flag is\n * active, then the automatic focus script does not happen.\n *\n * To prevent conflicts with multiple Select2 widgets opening at once, a second\n * flag is used to indicate the open status of a Select2 widget.  It was\n * necessary to use a flag instead of reading the class '--open' because using the\n * class '--open' as an indicator flag caused timing/bubbling issues.\n *\n * To simulate a Shift+Tab event, a flag is recorded every time the shift key\n * is pressed.\n */\njQuery(document).ready(function($) {\n    var docBody = $(document.body);\n    var shiftPressed = false;\n    var clickedOutside = false;\n    //var keyPressed = 0;\n\n    var isIE11 = !!window.MSInputMethodContext && !!document.documentMode;\n\t\tif (!isIE11) {\n\t\t\tdocBody.on('keydown', function(e) {\n\t\t\t    var keyCaptured = (e.keyCode ? e.keyCode : e.which);\n\t\t\t    //shiftPressed = keyCaptured == 16 ? true : false;\n\t\t\t    if (keyCaptured == 16) { shiftPressed = true; }\n\t\t\t});\n\t\t\tdocBody.on('keyup', function(e) {\n\t\t\t    var keyCaptured = (e.keyCode ? e.keyCode : e.which);\n\t\t\t    //shiftPressed = keyCaptured == 16 ? true : false;\n\t\t\t    if (keyCaptured == 16) { shiftPressed = false; }\n\t\t\t});\n\n\t\t\tdocBody.on('mousedown', function(e){\n\t\t\t    // remove other focused references\n\t\t\t    clickedOutside = false;\n\t\t\t    // record focus\n\t\t\t    if ($(e.target).is('[class*=\"select2\"]')!=true) {\n\t\t\t        clickedOutside = true;\n\t\t\t    }\n\t\t\t});\n\n\t\t\tdocBody.on('select2:opening', function(e) {\n\t\t\t    // this element has focus, remove other flags\n\t\t\t    clickedOutside = false;\n\t\t\t    // flag this Select2 as open\n\t\t\t    $(e.target).attr('data-s2open', 1);\n\t\t\t});\n\t\t\tdocBody.on('select2:closing', function(e) {\n\t\t\t    // remove flag as Select2 is now closed\n\t\t\t    $(e.target).removeAttr('data-s2open');\n\t\t\t});\n\n\t\t\tdocBody.on('select2:close', function(e) {\n\t\t\t    var elSelect = $(e.target);\n\t\t\t    elSelect.removeAttr('data-s2open');\n\t\t\t    var currentForm = elSelect.closest('form');\n\t\t\t    var othersOpen = currentForm.has('[data-s2open]').length;\n\t\t\t    if (othersOpen == 0 && clickedOutside==false) {\n\t\t\t        /* Find all inputs on the current form that would normally not be focus`able:\n\t\t\t         *  - includes hidden <select> elements whose parents are visible (Select2)\n\t\t\t         *  - EXCLUDES hidden <input>, hidden <button>, and hidden <textarea> elements\n\t\t\t         *  - EXCLUDES disabled inputs\n\t\t\t         *  - EXCLUDES read-only inputs\n\t\t\t         */\n\t\t\t        var inputs = currentForm.find(':input:enabled:not([readonly], input:hidden, button:hidden, textarea:hidden)')\n\t\t\t            .not(function () {   // do not include inputs with hidden parents\n\t\t\t                return $(this).parent().is(':hidden');\n\t\t\t            });\n\t\t\t        var elFocus = null;\n\t\t\t        $.each(inputs, function (index) {\n\t\t\t            var elInput = $(this);\n\t\t\t            if (elInput.attr('id') == elSelect.attr('id')) {\n\t\t\t                if ( shiftPressed) { // Shift+Tab\n\t\t\t                    elFocus = inputs.eq(index - 1);\n\t\t\t                } else {\n\t\t\t                    elFocus = inputs.eq(index + 1);\n\t\t\t                }\n\t\t\t                return false;\n\t\t\t            }\n\t\t\t        });\n\t\t\t        if (elFocus !== null) {\n\t\t\t            // automatically move focus to the next field on the form\n\t\t\t            var isSelect2 = elFocus.siblings('.select2').length > 0;\n\t\t\t            if (isSelect2) {\n\t\t\t                elFocus.select2('open');\n\t\t\t            } else {\n\t\t\t                elFocus.focus();\n\t\t\t            }\n\t\t\t        }\n\t\t\t    }\n\t\t\t});\n\n\t\t\tdocBody.on('focus', '.select2', function(e) {\n\t\t\t    var elSelect = $(this).siblings('select');\n\t\t\t    if (elSelect.is('[disabled]')==false && elSelect.is('[data-s2open]')==false\n\t\t\t        && $(this).has('.select2-selection--single').length>0) {\n\t\t\t        elSelect.attr('data-s2open', 1);\n\t\t\t        elSelect.select2('open');\n\t\t\t    }\n\t\t\t});\n\t\t}\n});\n"]}
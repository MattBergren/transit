{"version":3,"sources":["pages/form-validation.js"],"names":["$","on","e","preventDefault","formTarget","data","goTo","validateForm","target","formFields","getRequiredFormFields","console","log","is","filter","field","targetId","id","hasErrors","checkForErrors","window","location","href","focus","parentFormField","parents","toggleErrorOnField","change","checkParent","closest","find","length","focusout","parentForm","hasClass","val","attr","matchField","targetFormFields","each","thisField","value","push","formHasErrors","formErrorCount","errorSummary","forEach","addClass","removeClass","text","reset","erroredFieldBlock","toggleClass"],"mappings":"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","file":"form-validation.js","sourcesContent":["// FORM ERROR HANDLING -- POP THE ERRORS\n\n// payments specific.\n$('[data-form-target]').on('click', function(e) {\n    e.preventDefault();\n    let formTarget = $(this).data('form-target');\n    let goTo = $(this).data('goto');\n    validateForm(formTarget, goTo);\n})\n\nfunction validateForm(target, goTo) {\n    let formTarget = `[data-form=${target}]`\n    let formFields = getRequiredFormFields(formTarget)\n\n    console.log(formFields)\n    if (!$('#other-amount').is(':checked')) {\n\n        formFields = formFields.filter(function(field) {\n            let targetId = field.target[0].id;\n            if (targetId === 'other-amount-number' || targetId === 'total-amount' || targetId === 'other-amount') {\n                return false;\n            } else {\n                return true\n            }\n        })\n    }\n\n    console.log(formFields)\n\n    let hasErrors = checkForErrors(formTarget, formFields)\n\n    if (!hasErrors) {\n        window.location.href = goTo;\n    }\n}\n\n// global form validation -- turned off for now.\n// $('[data-form-target]').on('click', function(e) {\n//     e.preventDefault();\n//     let formTarget = $(this).data('form-target');\n//     let goTo = $(this).data('goto');\n//     validateForm(formTarget, goTo);\n// })\n\n$('[data-formfield]').focus(function() {\n    let parentFormField = $(this).parents('.longform__row')[0]\n    let target = $(this)\n    toggleErrorOnField(target, true)\n})\n\n$('[data-form] fieldset :checkbox, [data-form] fieldset :radio').change(function() {\n    let parentFormField = $(this).parents('.longform__row')[0]\n    let target = $(this)\n\n    // at the beginning, reset them\n    toggleErrorOnField(target, true)\n\n    let checkParent = target.closest('fieldset')\n\n    if (checkParent.find(':checked').length < 1) {\n        toggleErrorOnField(target)\n    }\n\n})\n\n$('[data-formfield]').focusout(function() {\n\n    let parentForm = $(this).parents('[data-form]')[0]\n    let target = $(this)\n\n    // only do error toggling if form has already been submitted\n    if ($(parentForm).hasClass('has-errors')) {\n        let parentFormField = $(this).parents('.longform__row')[0]\n\n        // at the beginning, reset them\n        toggleErrorOnField(target, true)\n        if (target.is( 'select' )) {\n            if (target.find(':selected').is(':disabled')) {\n                toggleErrorOnField(target);\n            }\n        } else if (target.val() == false) {\n            toggleErrorOnField(target);\n        }\n    }\n\n    if ($(this).attr('data-matchfield')) {\n        toggleErrorOnField(target, true)\n        let matchField = $(this).data('matchfield')\n\n        if ($(this).val() !== $(`[data-formfield=${matchField}]`).val()) {\n            toggleErrorOnField(target)\n        }\n    }\n\n})\n\nfunction getRequiredFormFields(formTarget) {\n    let targetFormFields = [];\n    $(`${formTarget} :input:not(:button,:hidden,[data-optional])`).each(function(){\n        let thisField = {\n            target: $(this),\n            value: $(this).val()\n        }\n        targetFormFields.push(thisField)\n    });\n    return targetFormFields\n}\n\nfunction checkForErrors(formTarget, formFields) {\n\n    var formHasErrors = false,\n        formErrorCount = 0,\n        errorSummary = $(`${formTarget} .error-summary`)\n\n    formFields.forEach(function(field) {\n        let target = field.target\n        // at the beginning, reset them\n        toggleErrorOnField(target, true)\n        if (target.is(':radio, :checkbox')) {\n            let checkParent = target.closest('fieldset')\n\n            if (checkParent.find(':checked').length < 1) {\n                toggleErrorOnField(target)\n            }\n        }\n        if (target.is( 'select' )) {\n            if (target.find(':selected').is(':disabled')) {\n                formErrorCount++;\n                toggleErrorOnField(target);\n                formHasErrors = true;\n            }\n        } else if (target.val() == false) {\n            formErrorCount++;\n            toggleErrorOnField(target);\n            formHasErrors = true;\n        }\n\n    });\n\n    if (formErrorCount > 0) {\n        $(formTarget).addClass('has-errors');\n        errorSummary.removeClass('hidden');\n        errorSummary.find('.error-summary-count').text(formErrorCount);\n    } else {\n        errorSummary.addClass('hidden')\n    }\n\n    return formHasErrors;\n}\n\nfunction toggleErrorOnField(field, reset) {\n    var erroredFieldBlock = field.parents('.longform__row');\n\n    if (reset) {\n        erroredFieldBlock.removeClass('has-error')\n    } else {\n        erroredFieldBlock.toggleClass('has-error');\n    }\n}\n\n// $('[data-validation]').keypress(function(event) {\n//   var key = event.key;\n//   var valMethod = $(this).data('validation')\n//   if (valMethod === 'numbersAndSpaces') {\n//       var regex = /[0-9 ]+/\n//       console.log(regex.test(key))\n//       return regex.test(key)\n//   }\n// })\n"]}
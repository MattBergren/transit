$(document).ready(function(){function e(e,a,t){var s=[];if(t)for(a;a>=e;a--)1===a.toString().length?s.push("0"+a.toString()):s.push(a.toString());else for(e;e<=a;e++)1===e.toString().length?s.push("0"+e.toString()):s.push(e.toString());return s}function a(e,a){var t=$(e.content());if(t.children().length<=0)return!1}function t(e,a){function t(e,a){var t=e.attr("class"),s=!0;r.each(function(e,n){$(this).hasClass(t)&&("add"===a?s=!1:"remove"===a&&(r.splice(e,1),o=!0))}),s&&"add"===a&&(o=!0,d.push(e))}var s=e.split(""),r=$(a.content()).find("p"),n=$(a.elementOrigin()).attr("id"),o=!1,d=[];if("username"===n){var l=$('<p class="usrnm-length">At least 5 characters</p>'),c=$('<p class="usrnm-number">At least 1 number</p>'),p=$('<p class="usrnm-spaces">No spaces</p>'),m=($('<p class="usrnm-group">Cannot use health plan group number</p>'),$('<p class="usrnm-special">Can contain special characters (@_-,#)</p>')),u=!1,f=!1;s.length<5?t(l,"add"):t(l,"remove");for(i in s){var h=s[i];$.isNumeric(h)&&(u=!0),h.indexOf(" ")>=0&&(f=!0)}u?t(c,"remove"):t(c,"add"),f?t(p,"add"):t(p,"remove"),/^[a-zA-Z0-9@_\-,#. ]*$/.test(e)===!1?t(m,"add"):t(m,"remove")}else if("password"===n){var l=$('<p class="password-length">At least 8 characters</p>'),c=$('<p class="password-number">At least 1 number</p>'),v=$('<p class="password-uppercase">An uppercase letter</p>'),g=$('<p class="password-lowercase">A lowercase letter</p>'),m=$('<p class="password-special">At least 1 special character (@_-,#)</p>'),b=$('<p class="password-username">Cannot be the same as username</p>'),w=$('<p class="password-firstname">Cannot be first name</p>'),C=$('<p class="password-lastname">Cannot be last name</p>'),y=$('<p class="password-repeat">Cannot contain four or more repeating numbers, letters, or characters</p>'),A=$('<p class="password-sequential">Cannot contain three or more sequential numbers or letters (123, ABC)</p>'),p=$('<p class="password-spaces">No spaces</p>'),q=$('<p class="password-member">Cannot use your member ID number</p>'),x=null!==e.match(/(.)\1\1\1+/g),u=!1,S=!1,T=!1,I=!1,f=!1;s.length<8?t(l,"add"):t(l,"remove");for(i in s){var M=parseInt(i),h=s[M];if($.isNumeric(h)&&(u=!0),h!==h.toUpperCase()||$.isNumeric(h)||/^[a-zA-Z0-9]*$/.test(h)!==!0||(S=!0),h!==h.toLowerCase()||$.isNumeric(h)||/^[a-zA-Z0-9]*$/.test(h)!==!0||(T=!0),M+2<=s.length-1){var z=function(e){var a=[];for(character in e){if(/^[a-zA-Z0-9]*$/.test(e[character])!==!0){a=[];break}a.push(e[character])}return a},D=z([s[M],String.fromCharCode(s[M].charCodeAt(0)+1),String.fromCharCode(s[M].charCodeAt(0)+2)]),L=z([s[M],s[M+1],s[M+2]]);if(D.length===L.length){var k=L.every(function(e,a){return e===D[a]});k&&(I=!0)}}h.indexOf(" ")>=0&&(f=!0)}u?t(c,"remove"):t(c,"add"),S?t(v,"remove"):t(v,"add"),T?t(g,"remove"):t(g,"add"),/^[a-zA-Z0-9 ]*$/.test(e)===!1?t(m,"remove"):t(m,"add"),$("#username").length>0&&($("#username").val()===e&&""!==e?t(b,"add"):t(b,"remove")),"john"===e.toLowerCase()?t(w,"add"):t(w,"remove"),"smith"===e.toLowerCase()?t(C,"add"):t(C,"remove"),x?t(y,"add"):t(y,"remove"),I?t(A,"add"):t(A,"remove"),f?t(p,"add"):t(p,"remove"),"12345"===e?t(q,"add"):t(q,"remove")}if(o===!0){var B='<div id="tooltip-username">';r.each(function(e,a){B+=$(this).prop("outerHTML")});for(i in d)B+=d[i].prop("outerHTML");B+="</div>",a.content(B),0===r.length&&0===d.length?a.close():!a.status().open&&$("#"+n).is(":focus")&&a.open()}}$("#register-form").validate({rules:{"member-id":"required",username:{required:!0,username:!0},password:{required:!0,password:!0},"password-confirm":{required:!0,equalTo:"#password"},email:"required","email-confirm":{required:!0,equalTo:"#email"},"dob-mm":{dob:!0,required:!0},"dob-dd":{dob:!0,required:!0},"dob-yyyy":{dob:!0,required:!0},medicareID:{orField:".field-group"},zip:{orField:".field-single"},firstname:{orField:".field-single"},lastname:{orField:".field-single"}},groups:{orGroup:"medicareID zip firstname lastname",dobGroup:"dob-mm dob-dd dob-yyyy"},highlight:function(e){$(e).closest(".field--dob").length>0?$(e).closest(".field--dob").addClass("field-has-error"):$(e).closest(".field").addClass("field-has-error")},unhighlight:function(e){if($(e).closest(".field--dob").length>0){var a=!1;$(e).closest(".field--dob").find("select").each(function(e,t){""!==$(this).val()&&$(this).val()||(a=!0)}),a||$(e).closest(".field--dob").removeClass("field-has-error")}else $(e).closest(".field").removeClass("field-has-error")},errorPlacement:function(e,a){$(a).closest(".field--dob").length>0?a.closest(".field--dob").append(e):$(a).closest(".field-or-option").length>0?a.closest(".field-or-option").append(e):a.closest(".field").append(e)}}),$.validator.addMethod("orField",function(e,a,t){var s=0;return $(t+" input").each(function(e,a){""!==$(this).val()&&s++}),!(s<=0&&e.length<1)},"Completion of at least one set of fields is required."),$.validator.addMethod("username",function(e,a){var t=$(m.content()).children().length;return this.optional(a)||t<=0},"Username does not meet requirements."),$.validator.addMethod("password",function(e,a){var t=$(u.content()).children().length;return console.log(t),this.optional(a)||t<=0},"Password does not meet requirements."),$.validator.addMethod("dob",function(e,a){var t=!1;return $(a).closest(".field--dob").find("select").each(function(e,a){""!==$(this).val()&&$(this).val()||(t=!0)}),!t},"Please complete all date fields."),$("#add-to-plan").click(function(e){e.preventDefault();var a=$("#register-form").valid();if(a){var t=$("#multiple-member-id").val();"12345"===t?($(".no-plan").addClass("hidden"),$(".additional-warning").addClass("hidden"),$("#existingPlanModal").modal("show")):"54321"===t?($(".additional-warning").removeClass("hidden"),$(".no-plan").addClass("hidden"),$("#multiple-member-id").closest(".field").addClass("field-has-error")):"11111"===t?($(".additional-warning").addClass("hidden"),$(".no-plan").removeClass("hidden"),$("#multiple-member-id").closest(".field").addClass("field-has-error")):""!==t&&($(".additional-warning").addClass("hidden"),$(".no-plan").addClass("hidden"),$("#addPlanModal").modal("show"))}}),$("#add-plan-confirm").click(function(e){$("#additional-plan-selector").addClass("hidden"),$(".additional-plan").removeClass("hidden")}),$("#add-plan-confirm-existing").click(function(e){$("#additional-plan-selector").addClass("hidden"),$(".additional-plan").removeClass("hidden"),$(".hidden-warning").removeClass("hidden")}),$("#continue-btn").click(function(e){var a=$("#register-form").valid();if($(".hidden-warning").is(":visible")&&(e.preventDefault(),$("#existingPlanWarningModal").modal("show")),a){var t=window.location.pathname;if(t.indexOf("step1")>=0)if("54321"===$("#member-id").val()){e.preventDefault();var s=$("#additional-info");s.is(":visible")?window.location.href="/register/register-step2.html":(s.prev().find("> [class*=col-]").css("z-index","10"),s.show(),s.length>0&&a&&(e.preventDefault(),TweenLite.fromTo(s,.8,{opacity:"0",transform:"translateY(-150px)"},{opacity:"1",transform:"translateY(0)"})),$("html, body").animate({scrollTop:s.offset().top},500),s.attr("tabindex","0").attr("aria-hidden","false").focus())}else{var r=$("#member-id").val(),n=$(".field--dob").find("select"),o=[];n.each(function(e,a){o.push($(this).val())}),r.length>0&&sessionStorage.setItem("member-id",r),o.length>0&&sessionStorage.setItem("dob",o)}if(t.indexOf("step2")>=0){var i=$("#additional-plan-selector");i.is(":visible")||$(".additional-plan").is(":visible")||(e.preventDefault(),i.removeClass("hidden"),i.prev().find("> [class*=col-]").css("z-index","10"),TweenLite.fromTo(i,.8,{opacity:"0",transform:"translateY(-150px)"},{opacity:"1",transform:"translateY(0)"}),$("html, body").animate({scrollTop:i.offset().top},500),i.attr("tabindex","0").attr("aria-hidden","false").focus())}}else e.preventDefault()});var s=document.getElementById("date-mm"),r=document.getElementById("date-dd"),n=document.getElementById("date-yyyy"),o=e(1,12),d=e(1,31),l=e(1930,2017,!0);$("#date-mm").select2({data:o,placeholder:" "}),$("#date-dd").select2({data:d,placeholder:" "}),$("#date-yyyy").select2({data:l,placeholder:" "});var c=sessionStorage.getItem("member-id"),p=sessionStorage.getItem("dob");null!==c&&c.length>0&&$("#member-id").attr("value",c),null!==p&&p.length>0&&(p=p.split(","),$(s).val(p[0]).trigger("change"),$(r).val(p[1]).trigger("change"),$(n).val(p[2]).trigger("change")),$(".tooltip-username").tooltipster({content:$("#tooltip-username"),contentCloning:!0,contentAsHTML:!0,interactive:!0,trigger:"custom",maxWidth:250,side:"right",functionBefore:a});var m=$(".tooltip-username").tooltipster("instance");$(".tooltip-password").tooltipster({content:$("#tooltip-password"),contentCloning:!0,contentAsHTML:!0,interactive:!0,trigger:"custom",maxWidth:250,side:"right",functionBefore:a});var u=$(".tooltip-password").tooltipster("instance"),f=$("#username"),h=$("#password");f.length>0&&t(f.val(),m),h.length>0&&t(h.val(),u),f.focus(function(e){m.open()}),f.blur(function(e){m.close()}),f.keyup(function(e){t($(this).val(),m)}),h.focus(function(e){u.open()}),h.blur(function(e){u.close()}),h.keyup(function(e){t($(this).val(),u)})});